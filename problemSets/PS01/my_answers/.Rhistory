set.seed (123)
data <- data.frame(x = runif(200, 1, 10))
data$y <- 0 + 2.75*data$x + rnorm(200, 0, 1.5)
lm_fit <- lm(y ~ x - 1, data = data)
coef(lm_fit)
ols_objective <- function(beta, y, x) {
sum((y - beta * x)^2)}
bfgs_fit <- optim(
par = 0,
fn = ols_objective,
y = data$y,
x = data$x,
method = "BFGS")
bfgs_fit$par
c(
lm_estimate   = coef(lm_fit),
bfgs_estimate = bfgs_fit$par)
max(abs(
fitted(lm_fit) - data$x * bfgs_fit$par))
